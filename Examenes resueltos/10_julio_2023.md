# Examen 10 de Julio 2023

Una empresa de internet distribuidora de contenidos audiovisuales mediante pago tiene una base de datos para gestionar las diferentes plataformas generadoras de contenido audiovisual digital. En el esquema de base de datos utilizado los atributos se abrevian según el siguiente convenio:

| Atributo | Significado                                      |
| -------- | ------------------------------------------------ |
| CAT      | Categoria de la pelicula: western, thriller, ... |
| DNI      | DNI del cliente                                  |
| F        | Fecha disponible/alquiler                        |
| P        | Identificador de la pelicula                     |
| PL       | Plataforma digital                               |
| PR       | Precio en Euros del alquiler de la pelicula      |


Las tablas utilizadas son:

**PELICULAS** (P, CAT)\
**SIGNIFICADO**: La pelicula P es de la categoria CAT.\
**CLAVE PRIMARIA**: (P)

**DISPONIBILIDAD** (PL, P, PR, F)\
**SIGNIFICADO**: La plataforma PL dispone de la pelicula P a un precio de PR euros por vision en la fechaF.\
**CLAVE PRIMARIA**: (PL, P, F)\
**CLAVE AJENA**: (P)

**ALQUILERES** (DNI, PL, P, F)\
**SIGNIFICADO**: La persona con dni DNI, ha alquilado la pelicula P a la plataforma PL en la fecha F.\
**CLAVE PRIMARIA**: (DNI, PL, P, F)\
**CLAVE AJENA**: (PL, P, F)

## 1. Responder en álgebra relacional las siguientes consultas:
a) Películas de la categoría C1 disponibles hoy en la plataforma PL1.
```sql
P(P) S((CAT = 'C1') AND (PL = 'PL1') AND (F = 'hoy')) (PELICULAS * DISPONIBILIDAD)
```

b) Personas que han alquilado las peliculas P1 y P2 en una misma plataforma.
```sql
A = P(DNI, PL) S(P = 'P1') (ALQUILERES)
B = P(DNI, PL) S(P = 'P2') (ALQUILERES)
P(DNI) (A ∩ B)
```

c) Plataforma que hoy dispone de la pelicula P1 con menor precio.
```sql
A = B = S(P = 'P1') (DISPONIBILIDAD)
C = P(PL) S((A.PL != B.PL) AND (A.PR > B.PR) AND (A.F = 'hoy')) (A x B)
P(PL) (A) - C
```

d) Personas que han alquilado al menos una pelicula de cada categoria en una misma plataforma.
```sql
A = P(DNI, CAT) (ALQUILERES * PELICULAS)
B = P(DNI, PL) (ALQUILERES)
C = P(DNI, PL) (ALQUILERES)
P(DNI) S((A.CAT = B.CAT) AND (A.CAT = C.CAT) AND (B.PL = C.PL)) (A x B x C)
```